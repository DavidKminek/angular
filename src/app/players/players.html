
<div class="player-form">
  <h3>Create New Player</h3>

  <form [formGroup]="playerForm" (ngSubmit)="createPlayer()">
    <input 
      type="text" 
      placeholder="Nickname (min 8 chars)"
      formControlName="nickname"
    >

    @if (playerForm.controls['nickname'].invalid && playerForm.controls['nickname'].touched) {
      <div class="error">
        Nickname must have at least 8 characters.
      </div>
    }

    <button 
      class="create-btn" 
      type="submit" 
      [disabled]="playerForm.invalid"
    >
      Create Player
    </button>
  </form>
</div>

<div class="filter-form">
  <h3>Filter by Level</h3>

  <form [formGroup]="filterForm">
    <select formControlName="levelTitle">
      <option [ngValue]="null">All Levels</option>

      @for (level of playerLevels; track level.title) {
        <option [ngValue]="level.title">
          {{ level.title }}
        </option>
      }
    </select>
  </form>

  <h3>Search by Nickname</h3>
  <app-search (searchChange)="onSearchChange($event)"></app-search>
</div>

<h2>Players</h2>

<ul class="player-list">
  @for (p of filteredPlayers(); track p.id) {
    <li>
      <div class="player-card">

        <span>
          {{ p.nickname }} -
          {{ getPlayerLevelForPlayer(p).level.title }}
          (Level {{ getPlayerLevelForPlayer(p).level.level }})
        </span>

        <span>- Clan: {{ getClanName(p) }}</span>

        <div class="progress-bar">
          <div
            class="progress"
            [style.width.%]="getPlayerLevelForPlayer(p).progress"
          ></div>
        </div>

        <div class="actions">
          <button (click)="goToDetails(p.id)">Details</button>
          <button class="danger" (click)="removePlayer(p.id)">Remove</button>
        </div>

      </div>
    </li>
  }

  @if (!filteredPlayers().length) {
    <li>No players found.</li>
  }
</ul>
